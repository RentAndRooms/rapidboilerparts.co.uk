import{o as a,j as o,a as e,r as n,e as ae,y as _,b as T,c as oe,w,i as S,v as le,t as l,s as z,m as x,F as j,k as P,h as b,l as C,u as p,n as de,A as ne,p as R}from"./app-GEAUTrCp.js";import{C as ie,Y as ue,G as ce,V as ge,S as ve}from"./CustomerLayout-JSNYRkyJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function ye(i,v){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"})])}function Z(i,v){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"})])}const me={key:0,id:"modal",class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 transition-opacity duration-300 ease-in-out"},xe={class:"bg-white rounded-2xl shadow-lg p-6 w-full max-w-md transform transition-all duration-300 scale-95 animate-fadeIn text-gray-700"},be={key:0,class:"mt-4"},pe={class:"block mb-2 text-sm font-medium"},fe={class:"mt-6 flex justify-end"},ke={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},he={key:0,class:"mb-4 p-4 bg-red-100 dark:bg-red-900/50 border border-red-400 text-red-700 dark:text-red-300 rounded"},_e={class:"mb-6 flex justify-between items-center"},we={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},Ce={class:"lg:col-span-2 space-y-6"},Ae={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},Me={class:"flex justify-between items-center mb-4"},Se={class:"text-lg font-medium text-orange-600 dark:text-orange-400"},je={key:0,class:"space-y-4"},Pe={class:"text-gray-900 dark:text-gray-200 font-medium"},Oe={class:"text-sm text-gray-600 dark:text-gray-400"},Ne={key:0,class:"text-sm text-gray-600 dark:text-gray-400"},Ve={class:"text-gray-900 dark:text-gray-200"},De={key:1,class:"text-gray-600 dark:text-gray-400 text-center py-4"},Be={key:0,class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},Fe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ie=["onClick"],Te={class:"flex items-start space-x-3"},ze={class:"text-gray-900 dark:text-gray-200 font-medium"},Ee={class:"text-sm text-gray-600 dark:text-gray-400"},Ue={key:1,class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},$e={class:"flex items-start space-x-3"},qe={class:"text-gray-900 dark:text-gray-200 font-medium"},Ye={class:"text-sm text-gray-600 dark:text-gray-400"},Le={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},Re={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ze=["onClick"],Ge={class:"text-gray-900 dark:text-gray-200 capitalize"},Je={class:"lg:col-span-1"},He={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 sticky top-4"},Qe={class:"space-y-3"},We={class:"flex justify-between text-gray-600 dark:text-gray-300"},Ke={key:0,class:"flex justify-between text-gray-600 dark:text-gray-300"},Xe={class:"border-t border-gray-200 dark:border-gray-700 pt-3"},et={class:"flex justify-between text-lg font-semibold text-gray-900 dark:text-gray-100"},tt=["disabled"],rt={key:0,class:"mt-3 text-sm text-red-600 dark:text-red-400 text-center"},st={class:"fixed inset-0 overflow-y-auto"},at={class:"flex min-h-full items-center justify-center p-4"},ot={class:"mt-4 space-y-4"},lt={class:"flex items-center"},ut={__name:"Checkout",props:{auth:Object,addresses:{type:Array,default:()=>[]},previous_url:{type:String,default:""},branch:{type:Object,required:!0,validator:i=>i&&typeof i.id<"u"}},setup(i){const v=i,O=n(!1),k=n(null),N=n(""),c=n([]),d=n(JSON.parse(localStorage.getItem("selectedItem")).order_type),f=n(null),h=n("mobile"),G=n(""),V=n(!1),A=n(!1),E=n({}),g=n({}),y=n({address_label:"",address:"",latitude:null,longitude:null,is_default:!1});ae(()=>{H(),d.value==="delivery"&&J()});const J=()=>{var s;if(((s=v.addresses)==null?void 0:s.length)>0){const t=v.addresses.find(r=>r.is_default)||v.addresses[0];f.value=t}},H=()=>{console.log(d.value,"focus");try{const s=localStorage.getItem("selectedItem");if(!s){U();return}const t=JSON.parse(s);console.log("Cart Data:",t),c.value=t.items,console.log("Cart items loaded:",c.value),console.log("cart itmes",c.value),d.value=t.order_type,console.log("Order Type set to:",d.value)}catch(s){console.error("Error loading cart:",s),$("Error loading cart data"),sessionStorage.removeItem("foodCart"),U()}},U=()=>{var s;(s=v.branch)!=null&&s.id?_.visit(route("customer.branch.menu",{branch:v.branch.id})):_.visit("/")},$=s=>{E.value={message:s},setTimeout(()=>{E.value={}},5e3)},M=T(()=>{var s;return(s=c.value)!=null&&s.length?c.value.reduce((t,r)=>t+Number(r.total),0):0}),D=T(()=>d.value==="delivery"?2.99:0),q=T(()=>{const s=M.value;return d.value==="delivery"?s+D.value:s}),Q=()=>d.value==="delivery"&&!f.value?(g.value.address="Please select a delivery address",!1):!0,W=()=>h.value?!0:(g.value.payment="Please select a payment method",!1),K=()=>{var s;return(s=c.value)!=null&&s.length?!0:(g.value.cart="Your cart is empty",!1)},X=()=>{const s=v.branch.minimum_order||0;return M.value<s?(g.value.minimum=`Minimum order amount is £${s}`,!1):!0},Y=()=>{var r,m,F;const s={order_type:d.value,branch_id:v.branch.id,items:c.value.map(u=>({food_id:u.id,quantity:u.qty,special_instructions:u.instructions||"",order_extras:u.selected_extras||[],unit_price:u.base_price,subtotal:u.total})),payment_method:h.value==="mobile"?k.value:h.value,paymentRef:N.value,subtotal:M.value,total_amount:q.value};g.value={},K()&&Q()&&W()&&X()&&(A.value=!0,d.value==="delivery"&&(s.delivery_address=(r=f.value)==null?void 0:r.address,s.delivery_latitude=(m=f.value)==null?void 0:m.latitude,s.delivery_longitude=(F=f.value)==null?void 0:F.longitude,s.delivery_notes=G.value,s.delivery_fee=D.value),console.log("Submitting order:",s),_.post(route("customer.orders.store"),s,{onSuccess:u=>{localStorage.removeItem("selectedItem");const I=u.url.split("/");console.log(I);const L=I[I.length-1];L?_.visit(route("customer.orders.show",{order:L})):($("Failed to process order. Please try again."),A.value=!1)},onError:u=>{console.error("Error:",u),A.value=!1,g.value=u}}))},ee=()=>{h.value!="mobile"?Y():O.value=!0},te=()=>{V.value=!0},B=()=>{V.value=!1,y.value={address_label:"",address:"",latitude:null,longitude:null,is_default:!1},g.value={}},re=()=>{_.post(route("customer.addresses.store"),y.value,{onSuccess:()=>{B(),_.reload({only:["addresses"]})},onError:s=>{g.value=s}})},se=s=>new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:2}).format(Number(s));return(s,t)=>(a(),oe(ie,null,{default:w(()=>[O.value?(a(),o("div",me,[e("div",xe,[t[7]||(t[7]=e("h2",{class:"text-xl font-semibold mb-4 text-center"},"Complete Payment",-1)),t[8]||(t[8]=e("label",{class:"block mb-2 text-sm font-medium"},"Choice Payment Method",-1)),S(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>k.value=r),class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"},t[6]||(t[6]=[e("option",{value:""},"Choose an option",-1),e("option",{value:"bikash"},"Bikash",-1),e("option",{value:"nogod"},"Nogod",-1),e("option",{value:"rocket"},"Rocket",-1)]),512),[[le,k.value]]),k.value?(a(),o("div",be,[e("p",null,"Pay to following "+l(k.value)+" number: 0122514244225",1),e("div",null,[e("label",pe,"Enter "+l(k.value)+" reference number:",1),S(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=r=>N.value=r)},null,512),[[z,N.value]])])])):x("",!0),e("div",fe,[e("button",{onClick:t[2]||(t[2]=r=>O.value=!1),class:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition"},"Close"),e("button",{onClick:Y,class:"ml-3 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition"},"Complete Payment")])])])):x("",!0),e("div",ke,[Object.keys(g.value).length>0?(a(),o("div",he,[(a(!0),o(j,null,P(g.value,(r,m)=>(a(),o("p",{key:m},l(r),1))),128))])):x("",!0),e("div",_e,[b(p(de),{href:i.previous_url,class:"text-sm px-3 py-1 rounded-md bg-blue-600 text-white hover:bg-blue-700 transition-colors duration-200"},{default:w(()=>t[9]||(t[9]=[C(" Back ")])),_:1},8,["href"])]),e("div",we,[e("div",Ce,[e("div",Ae,[e("div",Me,[t[10]||(t[10]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100"},"Order Summary",-1)),e("div",Se,l(d.value==="delivery"?"Delivery Order":"Collection Order"),1)]),c.value.length?(a(),o("div",je,[(a(!0),o(j,null,P(c.value,r=>(a(),o("div",{key:r.id,class:"flex justify-between items-start border-b border-gray-200 dark:border-gray-700 pb-4"},[e("div",null,[e("h3",Pe,l(r.name),1),e("p",Oe,"Quantity: "+l(r.qty),1),r.instructions?(a(),o("p",Ne,"Note: "+l(r.instructions),1)):x("",!0)]),e("span",Ve,[t[11]||(t[11]=e("span",{style:{"font-size":"30px"}},"৳",-1)),C(" "+l(r.total),1)])]))),128))])):(a(),o("div",De,"Your cart is empty"))]),d.value==="delivery"?(a(),o("div",Be,[e("div",{class:"flex justify-between items-center mb-4"},[t[12]||(t[12]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100"},"Delivery Address",-1)),e("button",{onClick:te,class:"text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300"},"+ Add New Address")]),e("div",Fe,[(a(!0),o(j,null,P(i.addresses,r=>{var m;return a(),o("div",{key:r.id,onClick:F=>f.value=r,class:R(["border rounded-lg p-4 cursor-pointer transition-colors duration-200",[((m=f.value)==null?void 0:m.id)===r.id?"border-orange-500 bg-orange-50 dark:bg-gray-700":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-gray-300 dark:hover:border-gray-600"]])},[e("div",Te,[b(p(Z),{class:"w-5 h-5 text-gray-400 flex-shrink-0"}),e("div",null,[e("p",ze,l(r.address_label),1),e("p",Ee,l(r.address),1)])])],10,Ie)}),128))])])):x("",!0),d.value!="delivery"?(a(),o("div",Ue,[t[14]||(t[14]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4"},"Food Provider",-1)),e("div",$e,[b(p(Z),{class:"w-5 h-5 text-gray-400 flex-shrink-0"}),e("div",null,[e("p",qe,l(i.branch.name),1),e("p",Ye,l(i.branch.address),1),t[13]||(t[13]=e("p",{class:"mt-2 text-sm text-orange-600"},"Please collect your order from this location",-1))])])])):x("",!0),e("div",Le,[t[15]||(t[15]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4"},"Payment Method",-1)),e("div",Re,[(a(),o(j,null,P(["cash","mobile"],r=>e("button",{key:r,onClick:m=>h.value=r,class:R(["flex items-center space-x-3 border rounded-lg p-4 transition-colors duration-200",[h.value===r?"border-orange-500 bg-orange-50 dark:bg-gray-700":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-gray-300 dark:hover:border-gray-600"]])},[b(p(ye),{class:"w-5 h-5 text-gray-400"}),e("span",Ge,l(r==="cash"?r:"Mobile Payment"),1)],10,Ze)),64))])])]),e("div",Je,[e("div",He,[t[22]||(t[22]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4"},"Order Total",-1)),e("div",Qe,[e("div",We,[t[17]||(t[17]=e("span",null,"Subtotal",-1)),e("span",null,[t[16]||(t[16]=e("span",{style:{"font-size":"30px"}},"৳",-1)),C(" "+l(M.value),1)])]),d.value==="delivery"?(a(),o("div",Ke,[t[19]||(t[19]=e("span",null,"Delivery Fee",-1)),e("span",null,[t[18]||(t[18]=e("span",{style:{"font-size":"30px"}},"৳",-1)),C(" "+l(D.value),1)])])):x("",!0),e("div",Xe,[e("div",et,[t[21]||(t[21]=e("span",null,"Total",-1)),e("span",null,[t[20]||(t[20]=e("span",{style:{"font-size":"30px"}},"৳",-1)),C(" "+l(q.value),1)])])])]),e("button",{onClick:ee,disabled:A.value||!c.value.length,class:"w-full mt-6 bg-orange-600 text-white py-3 px-4 rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},l(A.value?"Processing...":"Place Order"),9,tt),M.value<(i.branch.minimum_order||0)?(a(),o("div",rt,"Minimum order amount is "+l(se(i.branch.minimum_order)),1)):x("",!0)])])])]),b(p(ve),{appear:"",show:V.value,as:"template"},{default:w(()=>[b(p(ue),{as:"div",onClose:B,class:"relative z-50"},{default:w(()=>[t[27]||(t[27]=e("div",{class:"fixed inset-0 bg-black/50"},null,-1)),e("div",st,[e("div",at,[b(p(ce),{class:"w-full max-w-md transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 p-6 text-left align-middle shadow-xl transition-all"},{default:w(()=>[b(p(ge),{as:"h3",class:"text-lg font-medium text-gray-900 dark:text-gray-100"},{default:w(()=>t[23]||(t[23]=[C("Add New Address ")])),_:1}),e("div",ot,[e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Address Label ",-1)),S(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=r=>y.value.address_label=r),class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200",placeholder:"Home, Work, etc."},null,512),[[z,y.value.address_label]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Full Address ",-1)),S(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=r=>y.value.address=r),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-200"},null,512),[[z,y.value.address]])]),e("div",lt,[S(e("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=r=>y.value.is_default=r),class:"rounded border-gray-300 dark:border-gray-600 text-orange-600 focus:ring-orange-500"},null,512),[[ne,y.value.is_default]]),t[26]||(t[26]=e("label",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"}," Set as default address ",-1))])]),e("div",{class:"mt-6 flex justify-end space-x-3"},[e("button",{onClick:B,class:"px-4 py-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"},"Cancel"),e("button",{onClick:re,class:"px-4 py-2 text-sm bg-orange-600 text-white rounded-md hover:bg-orange-700 transition-colors duration-200"},"Save Address")])]),_:1})])])]),_:1})]),_:1},8,["show"])]),_:1}))}};export{ut as default};
